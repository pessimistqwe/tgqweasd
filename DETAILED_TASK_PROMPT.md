# ๐ EventPredict โ ะขะตัะฝะธัะตัะบะพะต ะทะฐะดะฐะฝะธะต ะฝะฐ ะดะพัะฐะฑะพัะบะธ

## ะะพะฝัะตะบัั ะฟัะพะตะบัะฐ

**EventPredict** โ prediction market ะฒ Telegram Mini App, ะบะปะพะฝ Polymarket.
- **URL:** https://eventpredict-production.up.railway.app
- **GitHub:** https://github.com/pessimistqwe/tgqweasd
- **ะกัะตะบ:** FastAPI + SQLAlchemy (backend), Vanilla JS (frontend), SQLite
- **ะะฝัะตะณัะฐัะธั:** Polymarket API ะดะปั ัะพะฑััะธะน, Telegram WebApp

---

## โ ะฃะถะต ะฒัะฟะพะปะฝะตะฝะพ (ะฟัะตะดัะดััะธะน ัะฐั)

### ะัะฟัะฐะฒะปะตะฝะธะต 502 Bad Gateway
- ะฃะฑัะฐะฝั ะฒัะทะพะฒั `fetch_polymarket_price_history()` ะธะท `upsert_polymarket_event()`
- ะะพะฑะฐะฒะปะตะฝะฐ ัะพะฝะพะฒะฐั ัะธะฝััะพะฝะธะทะฐัะธั ะธััะพัะธะธ ัะตะฝ (ะปะธะผะธั 10 ัะพะฑััะธะน)
- ะฃะปัััะตะฝะฐ ะพะฑัะฐะฑะพัะบะฐ ะธัะบะปััะตะฝะธะน (timeout, RequestException)
- ะัะฟัะฐะฒะปะตะฝ `startup_event()` โ ัะธะฝััะพะฝะธะทะฐัะธั ะฒ ะพัะดะตะปัะฝะพะผ ะฟะพัะพะบะต
- ะะพะฑะฐะฒะปะตะฝั ัะตััั: `test_comprehensive.py`, `test_deployment_full.py`
- **ะะตะทัะปััะฐั:** 600โ0 API ะทะฐะฟัะพัะพะฒ ะฟัะธ ััะฐััะต, ะฒัะตะผั ััะฐััะฐ >30ัโ<5ั

---

## ๐ด ะะะะะงะ 1: ะัะฟัะฐะฒะปะตะฝะธะต ะธะทะพะฑัะฐะถะตะฝะธะน ะฒ Telegram Mini App

### ะัะพะฑะปะตะผะฐ
ะะทะพะฑัะฐะถะตะฝะธั ัะพะฑััะธะน ะทะฐะณััะถะฐัััั ะฝะฐ ัะฐะนัะต, ะฝะพ **ะฝะต ะพัะพะฑัะฐะถะฐัััั ะฒ Telegram Mini App**.

### ะัะธัะธะฝะฐ
- Telegram WebApp ะธะผะตะตั ัััะพะณะธะต CORS ะพะณัะฐะฝะธัะตะฝะธั
- Proxy endpoint `/proxy/image` ะฝะต ะฒะพะทะฒัะฐัะฐะตั ะฝัะถะฝัะต ะทะฐะณะพะปะพะฒะบะธ ะดะปั Telegram
- ะะพะทะผะพะถะฝะพ ะพััััััะฒะธะต `Cross-Origin-Resource-Policy` ะทะฐะณะพะปะพะฒะบะฐ

### ะขัะตะฑะพะฒะฐะฝะธั ะบ ัะตัะตะฝะธั

#### 1.1 Backend โ ะพะฑะฝะพะฒะธัั proxy endpoint
**ะคะฐะนะป:** `api/index.py`

**ะงัะพ ัะดะตะปะฐัั:**
1. ะะพะฑะฐะฒะธัั ัะฟะตัะธะฐะปัะฝัะน ัะตะถะธะผ ะดะปั Telegram WebApp
2. ะะตัะฝััั CORS ะทะฐะณะพะปะพะฒะบะธ:
   - `Access-Control-Allow-Origin: *`
   - `Cross-Origin-Resource-Policy: cross-origin`
   - `Access-Control-Allow-Headers: Content-Type`
3. ะัะฟะพะปัะทะพะฒะฐัั User-Agent TelegramBot ะดะปั ะทะฐะฟัะพัะพะฒ ะบ Polymarket
4. ะะพะฑะฐะฒะธัั ะบััะธัะพะฒะฐะฝะธะต ะธะทะพะฑัะฐะถะตะฝะธะน (Cache-Control: max-age=86400)

#### 1.2 Frontend โ ะพะฑัะฐะฑะพัะบะฐ ะดะปั Telegram
**ะคะฐะนะป:** `frontend/script.js`

**ะงัะพ ัะดะตะปะฐัั:**
1. ะะฟัะตะดะตะปะธัั ััะพ ะฟัะธะปะพะถะตะฝะธะต ะทะฐะฟััะตะฝะพ ะฒ Telegram (`tg.initDataUnsafe`)
2. ะะปั Telegram ะธัะฟะพะปัะทะพะฒะฐัั ัะฟะตัะธะฐะปัะฝัะน ะฟะฐัะฐะผะตัั `?telegram_webapp=1`
3. ะะพะฑะฐะฒะธัั fallback ะฝะฐ placeholder ะตัะปะธ ะธะทะพะฑัะฐะถะตะฝะธะต ะฝะต ะทะฐะณััะทะธะปะพัั
4. ะะพะณะธัะพะฒะฐัั ะพัะธะฑะบะธ ะทะฐะณััะทะบะธ ะฒ ะบะพะฝัะพะปั

#### 1.3 ะขะตััั
**ะคะฐะนะป:** `test_images.py` (ัะพะทะดะฐัั)

**ะขะตััั:**
- `test_image_proxy_returns_cors_headers()` โ ะฟัะพะฒะตัะบะฐ CORS ะทะฐะณะพะปะพะฒะบะพะฒ
- `test_image_proxy_for_telegram()` โ ะฟัะพะฒะตัะบะฐ ัะตะถะธะผะฐ ะดะปั Telegram
- `test_image_fallback_on_error()` โ ะฟัะพะฒะตัะบะฐ ััะพ placeholder ะพัะพะฑัะฐะถะฐะตััั ะฟัะธ ะพัะธะฑะบะต

---

## ๐ก ะะะะะงะ 2: ะัะฐัะธะบะธ ะบะฐะบ ะฝะฐ Polymarket

### ะขะตะบััะตะต ัะพััะพัะฝะธะต
- ะะตัะบะพะปัะบะพ ะปะธะฝะธะน ะดะปั ะบะฐะถะดะพะณะพ ะธััะพะดะฐ (Yes, No)
- ะัะพััะพะน ะดะธะทะฐะนะฝ ะฑะตะท ะณัะฐะดะธะตะฝัะฐ

### ะฆะตะปั
**ะะดะฝะฐ ะปะธะฝะธั** ั ะณัะฐะดะธะตะฝัะฝัะผ ะทะฐะฟะพะปะฝะตะฝะธะตะผ, ะธะดะตะฝัะธัะฝะพ Polymarket.

### ะขัะตะฑะพะฒะฐะฝะธั ะบ ัะตัะตะฝะธั

#### 2.1 ะะธะทะฐะนะฝ ะณัะฐัะธะบะฐ (ะบะฐะบ ะฝะฐ Polymarket)
**ะะธะทัะฐะปัะฝัะต ััะตะฑะพะฒะฐะฝะธั:**
- **ะะดะฝะฐ ะปะธะฝะธั** ะดะปั ะพัะฝะพะฒะฝะพะณะพ ะธััะพะดะฐ (Yes/Up)
- **ะฆะฒะตั ะปะธะฝะธะธ:** ะทะตะปัะฝัะน `#22c55e` (ะธะปะธ ะบะฐะบ ะฝะฐ Polymarket)
- **ะัะฐะดะธะตะฝั ัะพะฝะฐ:**
  - ะกะฒะตััั (100%): ะทะตะปัะฝัะน ั ะฟัะพะทัะฐัะฝะพัััั 60% `rgba(34, 197, 94, 0.6)`
  - ะะพัะตัะตะดะธะฝะต (50%): ะฟะตัะตัะพะด
  - ะกะฝะธะทั (0%): ะบัะฐัะฝัะน ั ะฟัะพะทัะฐัะฝะพัััั 50% `rgba(239, 68, 68, 0.5)`
- **ะกัะธะปั ะปะธะฝะธะธ:**
  - ะขะพะปัะธะฝะฐ: 2px
  - ะกะณะปะฐะถะธะฒะฐะฝะธะต: `tension: 0.4` (ะฟะปะฐะฒะฝะฐั ะบัะธะฒะฐั)
  - ะะตะท ัะพัะตะบ (pointRadius: 0)
  - ะัะธ ะฝะฐะฒะตะดะตะฝะธะธ: ัะพัะบะฐ 5px

#### 2.2 ะัะธ ะธ ัะตัะบะฐ
**X-ะพัั (ะฒัะตะผั):**
- ะะพะบะฐะทัะฒะฐัั ะฟะพัะปะตะดะฝะธะต 24-48 ัะฐัะพะฒ
- ะคะพัะผะฐั: "HH:MM" ะดะปั ัะตะณะพะดะฝั, "MMM DD" ะดะปั ััะฐััั
- ะะฐะบัะธะผัะผ 6 ะผะตัะพะบ
- ะฆะฒะตั ัะตะบััะฐ: `#71717a`
- ะะตะท ัะตัะบะธ

**Y-ะพัั (ัะตะฝะฐ):**
- ะะธะฐะฟะฐะทะพะฝ: 0% ะดะพ 100%
- ะคะพัะผะฐั: "50%", "75%" ะธ ั.ะด.
- ะฆะฒะตั ัะตะบััะฐ: `#71717a`
- ะกะตัะบะฐ: ัะพะฝะบะฐั, ะฟัะพะทัะฐัะฝะพััั 5%

#### 2.3 Tooltip
**ะกัะธะปั:**
- ะคะพะฝ: ััะผะฝัะน `rgba(15, 15, 18, 0.95)`
- ะะฐะณะพะปะพะฒะพะบ: ะฑะตะปัะน `#fff`
- ะขะตะบัั: ัะตััะน `#a1a1aa`
- ะัะฐะฝะธัะฐ: ะฟัะพะทัะฐัะฝะฐั ะฑะตะปะฐั `rgba(255,255,255,0.1)`
- ะััััะฟั: 12px
- ะคะพัะผะฐั ัะตะฝั: "Price: 65.5%"

#### 2.4 Frontend ะธะทะผะตะฝะตะฝะธั
**ะคะฐะนะป:** `frontend/script.js`, ััะฝะบัะธั `renderEventChart()`

**ะงัะพ ะธะทะผะตะฝะธัั:**
1. ะัะฟะพะปัะทะพะฒะฐัั ัะพะปัะบะพ ะพะดะฝั ะปะธะฝะธั (ะดะปั Yes/Up ะพะฟัะธะธ)
2. ะะพะฑะฐะฒะธัั ะณัะฐะดะธะตะฝั ัะตัะตะท `CanvasGradient` (Chart.js `createLinearGradient`)
3. ะะฑะฝะพะฒะธัั ะฝะฐัััะพะนะบะธ ะพัะตะน ะธ tooltip
4. ะกะบัััั ะปะตะณะตะฝะดั (ะบะฐะบ ะฝะฐ Polymarket)

#### 2.5 ะขะตััั
**ะคะฐะนะป:** `test_charts.py` (ะพะฑะฝะพะฒะธัั)

**ะขะตััั:**
- `test_chart_single_line()` โ ะฟัะพะฒะตัะบะฐ ััะพ ะพะดะฝะฐ ะปะธะฝะธั
- `test_chart_gradient_exists()` โ ะฟัะพะฒะตัะบะฐ ะฝะฐะปะธัะธั ะณัะฐะดะธะตะฝัะฐ ะฒ ะบะพะดะต
- `test_chart_endpoint_returns_data()` โ ะฟัะพะฒะตัะบะฐ API endpoint
- `test_chart_data_structure()` โ ะฟัะพะฒะตัะบะฐ ััััะบัััั ะดะฐะฝะฝัั (price, timestamp, option_index)

---

## ๐ข ะะะะะงะ 3: ะะพะผะผะตะฝัะฐัะธะธ ะบ ัะพะฑััะธัะผ

### ะคัะฝะบัะธะพะฝะฐะปัะฝะพััั
- ะะฐะทะดะตะป ะบะพะผะผะตะฝัะฐัะธะตะฒ ะฟะพะด ะบะฐะถะดัะผ ัะพะฑััะธะตะผ
- ะะพะทะผะพะถะฝะพััั ะพััะฐะฒะธัั ะบะพะผะผะตะฝัะฐัะธะน
- ะัะพะฑัะฐะถะตะฝะธะต ัะฟะธัะบะฐ ะบะพะผะผะตะฝัะฐัะธะตะฒ
- ะะพะดะตัะฐัะธั ะบะพะฝัะตะฝัะฐ (ะฐะฒัะพ-ัะธะปัััั)

### ะขัะตะฑะพะฒะฐะฝะธั ะบ ัะตัะตะฝะธั

#### 3.1 Backend โ ะผะพะดะตะปั ะดะฐะฝะฝัั
**ะคะฐะนะป:** `api/models.py`

**ะะพะฒะฐั ะผะพะดะตะปั `EventComment`:**
```python
class EventComment(Base):
    __tablename__ = "event_comments"
    
    id = Column(Integer, primary_key=True)
    event_id = Column(Integer, ForeignKey("events.id"))
    user_id = Column(Integer, ForeignKey("users.id"))
    telegram_id = Column(Integer, nullable=False)
    username = Column(String(255))
    comment_text = Column(Text, nullable=False)
    created_at = Column(DateTime, default=datetime.utcnow)
    is_deleted = Column(Boolean, default=False)
    is_hidden = Column(Boolean, default=False)  # ะกะบัััะพ ะผะพะดะตัะฐัะธะตะน
```

#### 3.2 Backend โ ัะธะปัััะฐัะธั ะบะพะฝัะตะฝัะฐ
**ะคะฐะนะป:** `api/index.py`

**ะขัะตะฑะพะฒะฐะฝะธั ะบ ะผะพะดะตัะฐัะธะธ:**
1. **ะะฐะฟัะตั ัััะปะพะบ:**
   - ะะปะพะบะธัะพะฒะฐัั http://, https://, www.
   - ะะปะพะบะธัะพะฒะฐัั ะดะพะผะตะฝั ะฒ ัะตะบััะต
   - Regex: `r'https?://\S+|www\.\S+'`

2. **ะะฐะฟัะตั ะพัะบะพัะฑะปะตะฝะธะน:**
   - ะกะฟะธัะพะบ ััะพะฟ-ัะปะพะฒ (ะผะฐั, ะพัะบะพัะฑะปะตะฝะธั)
   - ะัะพะฒะตัะบะฐ ะฟะพ ัะฟะธัะบั ะฟะตัะตะด ะฟัะฑะปะธะบะฐัะธะตะน
   - ะะฒัะพะผะฐัะธัะตัะบะฐั ัะบัััะธะต ะบะพะผะผะตะฝัะฐัะธะตะฒ ั ะฝะฐัััะตะฝะธัะผะธ

3. **ะะธะผะธัั:**
   - ะะฐะบัะธะผัะผ 1000 ัะธะผะฒะพะปะพะฒ
   - ะะต ะฑะพะปะตะต 3 ะบะพะผะผะตะฝัะฐัะธะตะฒ ะฒ ะผะธะฝััั (rate limiting)

#### 3.3 Backend โ API endpoints
**ะคะฐะนะป:** `api/index.py`

**Endpoints:**

1. `GET /events/{event_id}/comments` โ ะฟะพะปััะธัั ะบะพะผะผะตะฝัะฐัะธะธ
   - ะะพะทะฒัะฐัะฐะตั ะดะพ 50 ะฟะพัะปะตะดะฝะธั ะบะพะผะผะตะฝัะฐัะธะตะฒ
   - ะขะพะปัะบะพ ะฝะต ัะบััััะต (`is_hidden=False`)
   - ะกะพััะธัะพะฒะบะฐ: ะฝะพะฒัะต ัะฒะตััั

2. `POST /events/{event_id}/comments` โ ะดะพะฑะฐะฒะธัั ะบะพะผะผะตะฝัะฐัะธะน
   - ะัะพะฒะตัะบะฐ rate limiting
   - ะัะพะฒะตัะบะฐ ะฝะฐ ะทะฐะฟัะตััะฝะฝัะน ะบะพะฝัะตะฝั
   - ะะฒัะพะผะฐัะธัะตัะบะฐั ะฟัะฑะปะธะบะฐัะธั ะตัะปะธ ะฒัั ัะธััะพ

3. `DELETE /admin/comments/{comment_id}` โ ัะดะฐะปะธัั ะบะพะผะผะตะฝัะฐัะธะน (ะฐะดะผะธะฝ)
   - ะขะพะปัะบะพ ะดะปั ะฐะดะผะธะฝะธัััะฐัะพัะพะฒ
   - ะัะณะบะพะต ัะดะฐะปะตะฝะธะต (`is_deleted=True`)

#### 3.4 Frontend โ UI
**ะคะฐะนะป:** `frontend/script.js`

**ะงัะพ ะดะพะฑะฐะฒะธัั:**

1. **ะกะตะบัะธั ะบะพะผะผะตะฝัะฐัะธะตะฒ ะฒ ะผะพะดะฐะปัะฝะพะผ ะพะบะฝะต ัะพะฑััะธั:**
   - ะะฐะณะพะปะพะฒะพะบ "ะะพะผะผะตะฝัะฐัะธะธ (N)"
   - ะกะฟะธัะพะบ ะบะพะผะผะตะฝัะฐัะธะตะฒ
   - ะคะพัะผะฐ ะดะพะฑะฐะฒะปะตะฝะธั (textarea + ะบะฝะพะฟะบะฐ)

2. **ะัะพะฑัะฐะถะตะฝะธะต ะบะพะผะผะตะฝัะฐัะธั:**
   - ะะผั ะฟะพะปัะทะพะฒะฐัะตะปั
   - ะัะตะผั ะฟัะฑะปะธะบะฐัะธะธ ("5 ะผะธะฝ ะฝะฐะทะฐะด")
   - ะขะตะบัั ะบะพะผะผะตะฝัะฐัะธั
   - ะะฝะดะธะบะฐัะพั ะตัะปะธ ัะบัััะพ ะผะพะดะตัะฐัะธะตะน

3. **ะะฐะปะธะดะฐัะธั:**
   - ะัะพะฒะตัะบะฐ ะดะปะธะฝั (โค1000)
   - ะัะตะดัะฟัะตะถะดะตะฝะธะต ะตัะปะธ ะตััั ัััะปะบะธ
   - ะะปะพะบะธัะพะฒะบะฐ ะพัะฟัะฐะฒะบะธ ะฟัะธ ะฝะฐัััะตะฝะธัั

#### 3.5 ะขะตััั
**ะคะฐะนะป:** `test_comments.py` (ัะพะทะดะฐัั)

**ะขะตััั:**
- `test_comments_api_get()` โ ะฟะพะปััะตะฝะธะต ะบะพะผะผะตะฝัะฐัะธะตะฒ
- `test_comments_api_post()` โ ะดะพะฑะฐะฒะปะตะฝะธะต ะบะพะผะผะตะฝัะฐัะธั
- `test_comments_block_links()` โ ะฑะปะพะบะธัะพะฒะบะฐ ัััะปะพะบ
- `test_comments_block_profanity()` โ ะฑะปะพะบะธัะพะฒะบะฐ ะพัะบะพัะฑะปะตะฝะธะน
- `test_comments_rate_limit()` โ rate limiting
- `test_comments_admin_delete()` โ ัะดะฐะปะตะฝะธะต ะฐะดะผะธะฝะพะผ

---

## ๐ข ะะะะะงะ 4: ะะตะดะฐะบัะธัะพะฒะฐะฝะธะต ะฟัะพัะธะปั

### ะคัะฝะบัะธะพะฝะฐะปัะฝะพััั
- ะะทะผะตะฝะตะฝะธะต ะธะผะตะฝะธ ะฟะพะปัะทะพะฒะฐัะตะปั
- ะะฐะณััะทะบะฐ ะฐะฒะฐัะฐัะฐ (ัะฐะนะปะพะผ)
- ะัะตะดะฟัะพัะผะพัั ะฟะตัะตะด ัะพััะฐะฝะตะฝะธะตะผ

### ะขัะตะฑะพะฒะฐะฝะธั ะบ ัะตัะตะฝะธั

#### 4.1 Backend โ ะผะพะดะตะปั ะดะฐะฝะฝัั
**ะคะฐะนะป:** `api/models.py`

**ะะฑะฝะพะฒะธัั ะผะพะดะตะปั `User`:**
```python
class User(Base):
    # ... ัััะตััะฒัััะธะต ะฟะพะปั ...
    custom_username = Column(String(255), nullable=True)  # ะะพะปัะทะพะฒะฐัะตะปััะบะพะต ะธะผั
    avatar_url = Column(String(500), nullable=True)  # URL ะฐะฒะฐัะฐัะฐ
```

#### 4.2 Backend โ ะทะฐะณััะทะบะฐ ะฐะฒะฐัะฐัะพะฒ
**ะคะฐะนะป:** `api/index.py`

**ะะพะฒัะน endpoint:**
- `POST /user/profile/upload-avatar`
- ะัะธะฝะธะผะฐะตั `multipart/form-data` ั ัะฐะนะปะพะผ
- ะะฐะปะธะดะฐัะธั:
  - ะขะธะฟ: image/jpeg, image/png, image/webp
  - ะะฐะทะผะตั: ะดะพ 5MB
  - ะะฐะทะผะตัั: ะดะพ 1000x1000px
- ะกะพััะฐะฝะตะฝะธะต:
  - ะััั: `/uploads/avatars/{telegram_id}_{timestamp}.jpg`
  - ะะพะทะฒัะฐัะฐะตั URL ะทะฐะณััะถะตะฝะฝะพะณะพ ัะฐะนะปะฐ

#### 4.3 Backend โ API endpoints
**ะคะฐะนะป:** `api/index.py`

**Endpoints:**

1. `GET /user/{telegram_id}/profile` โ ะฟะพะปััะธัั ะฟัะพัะธะปั
   - ะะพะทะฒัะฐัะฐะตั: telegram_id, username, custom_username, avatar_url, balance

2. `POST /user/profile/update` โ ะพะฑะฝะพะฒะธัั ะฟัะพัะธะปั
   - ะะพะปั: username (ะพะฟัะธะพะฝะฐะปัะฝะพ), avatar_url (ะพะฟัะธะพะฝะฐะปัะฝะพ)
   - ะะฐะปะธะดะฐัะธั ะดะปะธะฝั ะธะผะตะฝะธ (โค50 ัะธะผะฒะพะปะพะฒ)

3. `POST /user/profile/upload-avatar` โ ะทะฐะณััะทะธัั ะฐะฒะฐัะฐั
   - multipart/form-data
   - ะะพะทะฒัะฐัะฐะตั: { success: true, avatar_url: "..." }

#### 4.4 Frontend โ UI
**ะคะฐะนะป:** `frontend/script.js`

**ะงัะพ ะดะพะฑะฐะฒะธัั:**

1. **ะกะตะบัะธั ะฟัะพัะธะปั:**
   - ะัะพะฑัะฐะถะตะฝะธะต ัะตะบััะตะณะพ ะธะผะตะฝะธ ะธ ะฐะฒะฐัะฐัะฐ
   - ะะฝะพะฟะบะฐ "ะะตะดะฐะบัะธัะพะฒะฐัั" (ะธะบะพะฝะบะฐ ะบะฐัะฐะฝะดะฐัะฐ)

2. **ะะพะดะฐะปัะฝะพะต ะพะบะฝะพ ัะตะดะฐะบัะธัะพะฒะฐะฝะธั:**
   - ะะพะปะต ะดะปั ะธะผะตะฝะธ (input text)
   - ะะพะปะต ะดะปั ะฐะฒะฐัะฐัะฐ:
     - ะะฝะพะฟะบะฐ "ะะฐะณััะทะธัั ัะฐะนะป"
     - ะัะตะดะฟัะพัะผะพัั ะธะทะพะฑัะฐะถะตะฝะธั
     - ะะปะธ URL ะฟะพะปะต (ะพะฟัะธะพะฝะฐะปัะฝะพ)
   - ะะฝะพะฟะบะธ "ะกะพััะฐะฝะธัั" / "ะัะผะตะฝะฐ"

3. **ะะฐะณััะทะบะฐ ัะฐะนะปะฐ:**
   - Input type="file" accept="image/*"
   - ะัะตะดะฟัะพัะผะพัั ะฟะตัะตะด ะพัะฟัะฐะฒะบะพะน
   - ะัะพะณัะตัั ะฑะฐั ะฟัะธ ะทะฐะณััะทะบะต
   - ะะฑัะฐะฑะพัะบะฐ ะพัะธะฑะพะบ

#### 4.5 ะขะตััั
**ะคะฐะนะป:** `test_profile.py` (ัะพะทะดะฐัั)

**ะขะตััั:**
- `test_profile_get()` โ ะฟะพะปััะตะฝะธะต ะฟัะพัะธะปั
- `test_profile_update_username()` โ ะพะฑะฝะพะฒะปะตะฝะธะต ะธะผะตะฝะธ
- `test_profile_upload_avatar()` โ ะทะฐะณััะทะบะฐ ะฐะฒะฐัะฐัะฐ
- `test_profile_avatar_validation()` โ ะฒะฐะปะธะดะฐัะธั ัะฐะนะปะฐ
- `test_profile_avatar_size_limit()` โ ะปะธะผะธั ัะฐะทะผะตัะฐ

---

## ๐ ะกะฒะพะดะฝะฐั ัะฐะฑะปะธัะฐ ะทะฐะดะฐั

| ะัะธะพัะธัะตั | ะะฐะดะฐัะฐ | ะคะฐะนะปั | ะขะตััั | ะกะปะพะถะฝะพััั |
|-----------|--------|-------|-------|-----------|
| ๐ด P0 | ะะทะพะฑัะฐะถะตะฝะธั ะฒ Telegram | api/index.py, frontend/script.js | test_images.py | ะกัะตะดะฝัั |
| ๐ด P0 | ะัะฐัะธะบะธ ั ะณัะฐะดะธะตะฝัะพะผ | frontend/script.js | test_charts.py | ะกัะตะดะฝัั |
| ๐ก P1 | ะะพะผะผะตะฝัะฐัะธะธ | api/models.py, api/index.py, frontend/script.js | test_comments.py | ะััะพะบะฐั |
| ๐ก P1 | ะัะพัะธะปั | api/models.py, api/index.py, frontend/script.js | test_profile.py | ะกัะตะดะฝัั |

---

## ๐งช ะะฑัะธะต ััะตะฑะพะฒะฐะฝะธั ะบ ัะตััะฐะผ

### ะะปั ะฒัะตั ัะตััะพะฒ:
1. **ะะฒัะพะทะฐะฟััะบ ะฟะพัะปะต ะดะตะฟะปะพั** โ ัะตััั ะดะพะปะถะฝั ะทะฐะฟััะบะฐัััั ะฐะฒัะพะผะฐัะธัะตัะบะธ
2. **ะัะพะฒะตัะบะฐ ะฝะฐ production URL** โ ะธัะฟะพะปัะทะพะฒะฐัั `EVENTPREDICT_URL` ะฟะตัะตะผะตะฝะฝัั
3. **ะััััะฝะพััั** โ ะฒัะฒะพะดะธัั ะฟะพะฝััะฝัะต ัะพะพะฑัะตะฝะธั ะพะฑ ะพัะธะฑะบะฐั
4. **ะะต ะปะพะผะฐัั ัะฐะนั** โ ัะตััั ัะพะปัะบะพ ะดะปั ััะตะฝะธั ะธะปะธ ั ะพัะบะฐัะพะผ ะธะทะผะตะฝะตะฝะธะน

### ะกัััะบัััะฐ ัะตััะพะฒ:
```python
"""
EventPredict โ {Component} Tests

ะะฒัะพะผะฐัะธัะตัะบะธะต ัะตััั ะดะปั ะฟัะพะฒะตัะบะธ {component}
"""

import requests
import os

BASE_URL = os.getenv("EVENTPREDICT_URL", "http://localhost:8000")

def test_something():
    """ะะฟะธัะฐะฝะธะต ัะตััะฐ"""
    response = requests.get(f"{BASE_URL}/endpoint")
    assert response.status_code == 200
    # ...
```

---

## ๐ ะะพััะดะพะบ ัะตะฐะปะธะทะฐัะธะธ

### ะญัะฐะฟ 1: ะัะธัะธัะฝัะต ะธัะฟัะฐะฒะปะตะฝะธั (P0)
1. ะัะฟัะฐะฒะธัั ะธะทะพะฑัะฐะถะตะฝะธั ะดะปั Telegram
2. ะะฑะฝะพะฒะธัั ะณัะฐัะธะบะธ (ะณัะฐะดะธะตะฝั)
3. ะะฐะฟัััะธัั ัะตััั
4. ะะฐะดะตะฟะปะพะธัั

### ะญัะฐะฟ 2: ะะพะผะผะตะฝัะฐัะธะธ (P1)
1. ะกะพะทะดะฐัั ะผะพะดะตะปั EventComment
2. ะะพะฑะฐะฒะธัั API endpoints
3. ะะตะฐะปะธะทะพะฒะฐัั ัะธะปัััะฐัะธั (ัััะปะบะธ, ะพัะบะพัะฑะปะตะฝะธั)
4. ะะพะฑะฐะฒะธัั UI ะฒ frontend
5. ะขะตััั
6. ะะตะฟะปะพะน

### ะญัะฐะฟ 3: ะัะพัะธะปั (P1)
1. ะะฑะฝะพะฒะธัั ะผะพะดะตะปั User
2. ะะพะฑะฐะฒะธัั ะทะฐะณััะทะบั ะฐะฒะฐัะฐัะพะฒ
3. ะะพะฑะฐะฒะธัั UI ัะตะดะฐะบัะธัะพะฒะฐะฝะธั
4. ะขะตััั
5. ะะตะฟะปะพะน

---

## ๐ ะะพะฒัะต ัะฐะนะปั ะบะพัะพััะต ะฝัะถะฝะพ ัะพะทะดะฐัั

```
tgqweasd/
โโโ api/
โ   โโโ models.py          # ะะฑะฝะพะฒะธัั: +EventComment, +custom_username, +avatar_url
โ   โโโ index.py           # ะะฑะฝะพะฒะธัั: +endpoints ะดะปั ะบะพะผะผะตะฝัะฐัะธะตะฒ, ะฟัะพัะธะปั, avatar upload
โโโ frontend/
โ   โโโ script.js          # ะะฑะฝะพะฒะธัั: +ะณัะฐะดะธะตะฝั ะณัะฐัะธะบะพะฒ, +ะบะพะผะผะตะฝัะฐัะธะธ UI, +ะฟัะพัะธะปั UI
โ   โโโ styles.css         # ะะฑะฝะพะฒะธัั: +ััะธะปะธ ะดะปั ะบะพะผะผะตะฝัะฐัะธะตะฒ, ัะพัะผ ะฟัะพัะธะปั
โโโ uploads/
โ   โโโ avatars/           # ะะฐะฟะบะฐ ะดะปั ะฐะฒะฐัะฐัะพะฒ (ัะพะทะดะฐัั, ะดะพะฑะฐะฒะธัั ะฒ .gitignore)
โโโ tests/
โ   โโโ test_images.py     # ะขะตััั ะธะทะพะฑัะฐะถะตะฝะธะน
โ   โโโ test_charts.py     # ะขะตััั ะณัะฐัะธะบะพะฒ (ะพะฑะฝะพะฒะธัั)
โ   โโโ test_comments.py   # ะขะตััั ะบะพะผะผะตะฝัะฐัะธะตะฒ
โ   โโโ test_profile.py    # ะขะตััั ะฟัะพัะธะปั
โโโ TELEGRAM_FIXES.md      # ะญัะพั ะดะพะบัะผะตะฝั
```

---

## โ ะงะตะบะปะธัั ะฟัะธัะผะบะธ

### ะะทะพะฑัะฐะถะตะฝะธั:
- [ ] ะะทะพะฑัะฐะถะตะฝะธั ะทะฐะณััะถะฐัััั ะฒ Telegram Mini App
- [ ] CORS ะทะฐะณะพะปะพะฒะบะธ ะฟัะธัััััะฒััั
- [ ] Fallback ะฝะฐ placeholder ัะฐะฑะพัะฐะตั
- [ ] ะขะตััั ะฟัะพัะพะดัั

### ะัะฐัะธะบะธ:
- [ ] ะะดะฝะฐ ะปะธะฝะธั ั ะณัะฐะดะธะตะฝัะพะผ
- [ ] ะัะฐะดะธะตะฝั ะพั ะทะตะปัะฝะพะณะพ (60%) ะบ ะบัะฐัะฝะพะผั (50%)
- [ ] Tooltip ะพัะพะฑัะฐะถะฐะตััั ะบะพััะตะบัะฝะพ
- [ ] ะัะธ ะฝะฐัััะพะตะฝั ะฟัะฐะฒะธะปัะฝะพ
- [ ] ะขะตััั ะฟัะพัะพะดัั

### ะะพะผะผะตะฝัะฐัะธะธ:
- [ ] ะะพะถะฝะพ ะดะพะฑะฐะฒะธัั ะบะพะผะผะตะฝัะฐัะธะน
- [ ] ะกััะปะบะธ ะฑะปะพะบะธัััััั
- [ ] ะัะบะพัะฑะปะตะฝะธั ะฑะปะพะบะธัััััั
- [ ] ะะพะผะผะตะฝัะฐัะธะธ ะพัะพะฑัะฐะถะฐัััั
- [ ] ะขะตััั ะฟัะพัะพะดัั

### ะัะพัะธะปั:
- [ ] ะะพะถะฝะพ ะธะทะผะตะฝะธัั ะธะผั
- [ ] ะะพะถะฝะพ ะทะฐะณััะทะธัั ะฐะฒะฐัะฐั ัะฐะนะปะพะผ
- [ ] ะัะตะดะฟัะพัะผะพัั ัะฐะฑะพัะฐะตั
- [ ] ะะฐะปะธะดะฐัะธั ัะฐะฑะพัะฐะตั
- [ ] ะขะตััั ะฟัะพัะพะดัั

---

## ๐ ะะพะปะตะทะฝัะต ัััะปะบะธ

- **Polymarket:** https://polymarket.com (ัะผะพััะตัั ะณัะฐัะธะบะธ)
- **Telegram WebApp Docs:** https://core.telegram.org/bots/webapps
- **Chart.js Gradients:** https://www.chartjs.org/docs/latest/samples/area/gradient.html
- **GitHub ะฟัะพะตะบัะฐ:** https://github.com/pessimistqwe/tgqweasd

---

**ะกะปะตะดัััะธะน ัะฐะณ:** ะะฐัะฐัั ั ะะฐะดะฐัะธ 1 (ะธะทะพะฑัะฐะถะตะฝะธั) ะธ ะะฐะดะฐัะธ 2 (ะณัะฐัะธะบะธ) ะพะดะฝะพะฒัะตะผะตะฝะฝะพ, ัะฐะบ ะบะฐะบ ะพะฝะธ ะบัะธัะธัะฝั ะดะปั UX.
