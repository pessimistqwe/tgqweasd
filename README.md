# EventPredict ‚Äî Prediction Market –≤ Telegram

[![Python 3.12+](https://img.shields.io/badge/python-3.12+-blue.svg)](https://www.python.org/downloads/)
[![FastAPI](https://img.shields.io/badge/FastAPI-0.104+-green.svg)](https://fastapi.tiangolo.com/)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)

**EventPredict** ‚Äî —ç—Ç–æ –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π prediction market (—Ä—ã–Ω–æ–∫ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π) –≤ —Ñ–æ—Ä–º–∞—Ç–µ Telegram Mini App —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π Polymarket API –∏ Binance WebSocket –¥–ª—è —Ä–µ–∞–ª—å–Ω—ã—Ö —Ü–µ–Ω –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç.

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:
- **–¢–æ—Ä–≥–æ–≤–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è–º–∏** –Ω–∞ —Å–æ–±—ã—Ç–∏—è –∏–∑ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π (–ø–æ–ª–∏—Ç–∏–∫–∞, —Å–ø–æ—Ä—Ç, –∫—Ä–∏–ø—Ç–æ, –ø–æ–ø-–∫—É–ª—å—Ç—É—Ä–∞, –±–∏–∑–Ω–µ—Å, –Ω–∞—É–∫–∞)
- **Real-time –≥—Ä–∞—Ñ–∏–∫–∏** —Ü–µ–Ω –Ω–∞ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç—ã —á–µ—Ä–µ–∑ Binance WebSocket
- **–ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ –ø—Ä–æ–≥–Ω–æ–∑—ã** –Ω–∞ 5 –º–∏–Ω—É—Ç (–≤–≤–µ—Ä—Ö/–≤–Ω–∏–∑)
- **Long/Short –ø–æ–∑–∏—Ü–∏–∏** —Å –∫—Ä–µ–¥–∏—Ç–Ω—ã–º –ø–ª–µ—á–æ–º –¥–æ 100x
- **Polymarket-style —Å—Ç–∞–≤–∫–∏** –Ω–∞ –±–∏–Ω–∞—Ä–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è (Yes/No)
- **–ö–æ—à–µ–ª—ë–∫** —Å –¥–µ–ø–æ–∑–∏—Ç–∞–º–∏/–≤—ã–≤–æ–¥–∞–º–∏ —á–µ—Ä–µ–∑ CryptoBot
- **–ò—Å—Ç–æ—Ä–∏—è —Å—Ç–∞–≤–æ–∫** –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ç—Ä–µ–π–¥–∏–Ω–≥–∞

### –î–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤:
- **–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å** —Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏ –≤—ã–≤–æ–¥–∞–º–∏
- **–†—É—á–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è** —Å–æ–±—ã—Ç–∏–π –∏–∑ Polymarket
- **–ú–æ–¥–µ—Ä–∞—Ü–∏—è** —Å–æ–±—ã—Ç–∏–π –∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤
- **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã** –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç](#-–±—ã—Å—Ç—Ä—ã–π-—Å—Ç–∞—Ä—Ç)
- [–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞](#-—É—Å—Ç–∞–Ω–æ–≤–∫–∞-–∏-–Ω–∞—Å—Ç—Ä–æ–π–∫–∞)
- [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞](#-—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–ø—Ä–æ–µ–∫—Ç–∞)
- [API Endpoints](#-api-endpoints)
- [–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö](#-–±–∞–∑–∞-–¥–∞–Ω–Ω—ã—Ö)
- [–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ](#-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)
- [–î–µ–ø–ª–æ–π](#-–¥–µ–ø–ª–æ–π)
- [–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è](#-–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ-–æ–∫—Ä—É–∂–µ–Ω–∏—è)
- [–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫](#-—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π-—Å—Ç–µ–∫)

---

## üéØ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```bash
git clone https://github.com/yourusername/eventpredict.git
cd eventpredict
```

### 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install -r requirements.txt
```

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
cp .env.example .env
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ .env –∏ –¥–æ–±–∞–≤—å—Ç–µ TELEGRAM_BOT_TOKEN
```

### 4. –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

```bash
uvicorn api.index:app --reload --host 0.0.0.0 --port 8000
```

### 5. –û—Ç–∫—Ä—ã—Ç—å –≤ Telegram

–û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ —Å—Å—ã–ª–∫–µ: `https://t.me/yourbot?startapp=webapp`

---

## üõ† –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.12+
- PostgreSQL (–¥–ª—è production) –∏–ª–∏ SQLite (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)
- Telegram Bot Token (–æ—Ç @BotFather)
- CryptoBot API Token (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –¥–ª—è –ø–ª–∞—Ç–µ–∂–µ–π)

### –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
pip install -r requirements.txt

# –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ env —Ñ–∞–π–ª–∞
cp .env.example .env

# –ó–∞–ø—É—Å–∫ —Å –∞–≤—Ç–æ-—Ä–µ–ª–æ–∞–¥–æ–º
uvicorn api.index:app --reload --host 0.0.0.0 --port 8000
```

### Docker

```bash
# –°–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–∞
docker build -t eventpredict .

# –ó–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
docker run -p 8000:8000 \
  -e TELEGRAM_BOT_TOKEN=your_token \
  -e PORT=8000 \
  eventpredict
```

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
tgqweasd/
‚îú‚îÄ‚îÄ api/                        # Backend (FastAPI)
‚îÇ   ‚îú‚îÄ‚îÄ index.py               # –û—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ models.py              # SQLAlchemy –º–æ–¥–µ–ª–∏
‚îÇ   ‚îú‚îÄ‚îÄ betting_service.py     # Betting Engine (–±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞)
‚îÇ   ‚îú‚îÄ‚îÄ betting_repository.py  # –†–∞–±–æ—Ç–∞ —Å –ë–î
‚îÇ   ‚îú‚îÄ‚îÄ betting_routes.py      # API endpoints –¥–ª—è —Å—Ç–∞–≤–æ–∫
‚îÇ   ‚îú‚îÄ‚îÄ betting_resolver.py    # –§–æ–Ω–æ–≤—ã–π –≤–æ—Ä–∫–µ—Ä –¥–ª—è —Ä–∞—Å—á—ë—Ç–∞ —Å—Ç–∞–≤–æ–∫
‚îÇ   ‚îú‚îÄ‚îÄ betting_models.py      # Pydantic –º–æ–¥–µ–ª–∏ –¥–ª—è —Å—Ç–∞–≤–æ–∫
‚îÇ   ‚îú‚îÄ‚îÄ telegram_auth.py       # –í–∞–ª–∏–¥–∞—Ü–∏—è Telegram initData
‚îÇ   ‚îú‚îÄ‚îÄ main.py                # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –¥–ª—è –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º
‚îÇ   ‚îî‚îÄ‚îÄ requirements*.txt      # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ Python
‚îú‚îÄ‚îÄ frontend/                   # Frontend (Vanilla JS)
‚îÇ   ‚îú‚îÄ‚îÄ index.html             # –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
‚îÇ   ‚îú‚îÄ‚îÄ styles.css             # –°—Ç–∏–ª–∏
‚îÇ   ‚îî‚îÄ‚îÄ script.js              # –ö–ª–∏–µ–Ω—Ç—Å–∫–∞—è –ª–æ–≥–∏–∫–∞
‚îú‚îÄ‚îÄ tests/                      # –¢–µ—Å—Ç—ã (pytest)
‚îÇ   ‚îú‚îÄ‚îÄ test_betting_service.py
‚îÇ   ‚îú‚îÄ‚îÄ test_resolver.py
‚îÇ   ‚îî‚îÄ‚îÄ conftest.py
‚îú‚îÄ‚îÄ .env.example               # –®–∞–±–ª–æ–Ω –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ .gitignore                 # Git ignore –ø—Ä–∞–≤–∏–ª–∞
‚îú‚îÄ‚îÄ Dockerfile                 # Docker –æ–±—Ä–∞–∑
‚îú‚îÄ‚îÄ zeabur.json               # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Zeabur
‚îú‚îÄ‚îÄ railway.json              # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Railway
‚îú‚îÄ‚îÄ render.yaml               # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Render
‚îú‚îÄ‚îÄ fly.toml                  # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Fly.io
‚îú‚îÄ‚îÄ vercel.json               # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Vercel
‚îî‚îÄ‚îÄ README.md                 # –≠—Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

---

## üì° API Endpoints

### –ü—É–±–ª–∏—á–Ω—ã–µ endpoints

| –ú–µ—Ç–æ–¥ | Endpoint | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|----------|
| `GET` | `/` | –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ (frontend) |
| `GET` | `/api/categories` | –°–ø–∏—Å–æ–∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–π |
| `GET` | `/api/events?category={}` | –ü–æ–ª—É—á–∏—Ç—å —Å–æ–±—ã—Ç–∏—è |
| `GET` | `/api/user/{telegram_id}` | –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ |
| `GET` | `/health` | Health check |

### Betting API (—Ç—Ä–µ–±—É–µ—Ç Telegram initData)

| –ú–µ—Ç–æ–¥ | Endpoint | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|----------|
| `POST` | `/api/betting/event/place` | –†–∞–∑–º–µ—Å—Ç–∏—Ç—å —Å—Ç–∞–≤–∫—É –Ω–∞ —Å–æ–±—ã—Ç–∏–µ |
| `POST` | `/api/betting/price/place` | –†–∞–∑–º–µ—Å—Ç–∏—Ç—å —Å—Ç–∞–≤–∫—É –Ω–∞ —Ü–µ–Ω—É (Long/Short) |
| `POST` | `/api/betting/prediction/place` | –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–π –ø—Ä–æ–≥–Ω–æ–∑ (5 –º–∏–Ω) |
| `POST` | `/api/betting/cancel` | –û—Ç–º–µ–Ω–∏—Ç—å —Å—Ç–∞–≤–∫—É |
| `GET` | `/api/betting/my-bets` | –ú–æ–∏ —Å—Ç–∞–≤–∫–∏ |
| `GET` | `/api/betting/my-predictions` | –ú–æ–∏ –ø—Ä–æ–≥–Ω–æ–∑—ã |
| `GET` | `/api/betting/bet/{bet_id}` | –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å—Ç–∞–≤–∫–µ |
| `GET` | `/api/betting/market-stats/{market_id}` | –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ä—ã–Ω–∫–∞ |

### –ö–æ—à–µ–ª—ë–∫

| –ú–µ—Ç–æ–¥ | Endpoint | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|----------|
| `GET` | `/api/wallet/balance/{telegram_id}` | –ë–∞–ª–∞–Ω—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |
| `POST` | `/api/wallet/deposit` | –°–æ–∑–¥–∞—Ç—å –¥–µ–ø–æ–∑–∏—Ç |
| `POST` | `/api/wallet/withdraw` | –ó–∞–ø—Ä–æ—Å–∏—Ç—å –≤—ã–≤–æ–¥ |

### –ê–¥–º–∏–Ω–∫–∞

| –ú–µ—Ç–æ–¥ | Endpoint | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|----------|
| `POST` | `/api/admin/sync-polymarket` | –†—É—á–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è Polymarket |
| `GET` | `/api/admin/check/{telegram_id}` | –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ |
| `GET` | `/api/admin/stats` | –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã |
| `GET` | `/api/admin/withdrawals` | –°–ø–∏—Å–æ–∫ –≤—ã–≤–æ–¥–æ–≤ |
| `POST` | `/api/admin/withdrawal/action` | –û–¥–æ–±—Ä–∏—Ç—å/–æ—Ç–∫–ª–æ–Ω–∏—Ç—å –≤—ã–≤–æ–¥ |

---

## üóÑ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

### –¢–∞–±–ª–∏—Ü—ã

#### users
- `id` ‚Äî –ø–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á
- `telegram_id` ‚Äî Telegram ID (—É–Ω–∏–∫–∞–ª—å–Ω—ã–π)
- `username` ‚Äî –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `balance_usdt` ‚Äî –±–∞–ª–∞–Ω—Å –≤ USDT
- `balance_ton` ‚Äî –±–∞–ª–∞–Ω—Å –≤ TON
- `is_blocked` ‚Äî –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
- `is_admin` ‚Äî –ø—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

#### events (markets)
- `id` ‚Äî –ø–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á
- `polymarket_id` ‚Äî ID —Å–æ–±—ã—Ç–∏—è –≤ Polymarket
- `title` ‚Äî –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Å–æ–±—ã—Ç–∏—è
- `category` ‚Äî –∫–∞—Ç–µ–≥–æ—Ä–∏—è (crypto, politics, sports...)
- `end_time` ‚Äî –≤—Ä–µ–º—è –æ–∫–æ–Ω—á–∞–Ω–∏—è
- `is_active` ‚Äî –∞–∫—Ç–∏–≤–Ω–æ –ª–∏
- `is_resolved` ‚Äî —Ä–∞–∑—Ä–µ—à–µ–Ω–æ –ª–∏
- `correct_option` ‚Äî –≤—ã–∏–≥—Ä—ã—à–Ω—ã–π –æ–ø—Ü–∏–æ–Ω

#### bets
- `id` ‚Äî –ø–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á
- `user_id` ‚Äî –≤–ª–∞–¥–µ–ª–µ—Ü —Å—Ç–∞–≤–∫–∏
- `market_id` ‚Äî —Ä—ã–Ω–æ–∫
- `bet_type` ‚Äî —Ç–∏–ø (EVENT, PRICE, PRICE_PREDICTION)
- `direction` ‚Äî –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (YES/NO, LONG/SHORT, UP/DOWN)
- `amount` ‚Äî —Å—É–º–º–∞ —Å—Ç–∞–≤–∫–∏
- `shares` ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–∫—Ü–∏–π (–¥–ª—è Polymarket-style)
- `entry_price` ‚Äî —Ü–µ–Ω–∞ –≤—Ö–æ–¥–∞
- `leverage` ‚Äî –∫—Ä–µ–¥–∏—Ç–Ω–æ–µ –ø–ª–µ—á–æ
- `liquidation_price` ‚Äî —Ü–µ–Ω–∞ –ª–∏–∫–≤–∏–¥–∞—Ü–∏–∏
- `take_profit_price` ‚Äî —Ç–µ–π–∫-–ø—Ä–æ—Ñ–∏—Ç
- `stop_loss_price` ‚Äî —Å—Ç–æ–ø-–ª–æ—Å—Å
- `potential_payout` ‚Äî –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π –≤—ã–∏–≥—Ä—ã—à
- `actual_payout` ‚Äî —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–∏–≥—Ä—ã—à
- `status` ‚Äî —Å—Ç–∞—Ç—É—Å (pending, open, closed, cancelled)

#### price_predictions
- `id` ‚Äî –ø–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á
- `user_id` ‚Äî –≤–ª–∞–¥–µ–ª–µ—Ü –ø—Ä–æ–≥–Ω–æ–∑–∞
- `market_id` ‚Äî —Ä—ã–Ω–æ–∫
- `direction` ‚Äî LONG/SHORT
- `symbol` ‚Äî —Å–∏–º–≤–æ–ª –∞–∫—Ç–∏–≤–∞ (BTCUSDT)
- `amount` ‚Äî —Å—É–º–º–∞
- `odds` ‚Äî –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç
- `entry_price` ‚Äî —Ü–µ–Ω–∞ –≤—Ö–æ–¥–∞
- `exit_price` ‚Äî —Ü–µ–Ω–∞ –≤—ã—Ö–æ–¥–∞
- `duration_seconds` ‚Äî –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø—Ä–æ–≥–Ω–æ–∑–∞
- `status` ‚Äî —Å—Ç–∞—Ç—É—Å

#### transactions
- `id` ‚Äî –ø–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á
- `user_id` ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
- `type` ‚Äî —Ç–∏–ø (deposit, withdrawal, bet_placed, bet_won)
- `amount` ‚Äî —Å—É–º–º–∞
- `status` ‚Äî —Å—Ç–∞—Ç—É—Å
- `invoice_url` ‚Äî —Å—Å—ã–ª–∫–∞ –Ω–∞ –æ–ø–ª–∞—Ç—É

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ pytest
pip install pytest pytest-cov pytest-asyncio

# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤
pytest

# –ó–∞–ø—É—Å–∫ —Å –ø–æ–∫—Ä—ã—Ç–∏–µ–º
pytest --cov=api --cov-report=html

# –ó–∞–ø—É—Å–∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞
pytest tests/test_betting_service.py::test_race_condition -v
```

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —Ç–µ—Å—Ç-–∫–µ–π—Å—ã

| ‚Ññ | –ù–∞–∑–≤–∞–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---|----------|----------|
| 1 | `test_race_condition` | 2 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Å—Ç–∞–≤–∫–∏ —Å –æ–¥–Ω–∏–º –±–∞–ª–∞–Ω—Å–æ–º |
| 2 | `test_price_manipulation` | –°—Ç–∞–≤–∫–∞ —Å —Ü–µ–Ω–æ–π –Ω–∞ 5% –≤—ã—à–µ —Ä—ã–Ω–æ—á–Ω–æ–π |
| 3 | `test_payout_calculation` | –†–∞—Å—á–µ—Ç –≤—ã–ø–ª–∞—Ç—ã –¥–ª—è Long x10 |
| 4 | `test_state_consistency` | –í–æ—Ä–∫–µ—Ä –∑–∞–∫—Ä—ã–≤–∞–µ—Ç —Å—Ç–∞–≤–∫—É –ø–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É |
| 5 | `test_websocket_reconnect` | –û–±—Ä—ã–≤ —Å–≤—è–∑–∏ —Å Binance |
| 6 | `test_negative_balance` | –ü–æ–ø—ã—Ç–∫–∞ —Å—Ç–∞–≤–∫–∏ –±–æ–ª—å—à–µ –±–∞–ª–∞–Ω—Å–∞ |
| 7 | `test_decimal_precision` | –†–∞—Å—á–µ—Ç —Å –º–∞–ª–µ–Ω—å–∫–∏–º–∏ —Å—É–º–º–∞–º–∏ |

---

## üöÄ –î–µ–ø–ª–æ–π

### Zeabur (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

1. –°–æ–∑–¥–∞–π—Ç–µ –∞–∫–∫–∞—É–Ω—Ç –Ω–∞ [Zeabur](https://zeabur.com)
2. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
3. –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:
   - `TELEGRAM_BOT_TOKEN`
   - `PORT=8000`
   - `TEST_DB_PATH=/tmp/events.db`
4. Deploy!

–°–º. –ø–æ–¥—Ä–æ–±–Ω—É—é –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é –≤ [DEPLOY_ZEABUR.md](./DEPLOY_ZEABUR.md)

### –î—Ä—É–≥–∏–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã

- **Railway.app** ‚Äî —Å–º. `railway.json`
- **Render.com** ‚Äî —Å–º. `render.yaml`
- **Fly.io** ‚Äî —Å–º. `fly.toml`
- **Vercel** ‚Äî —Å–º. `vercel.json`

---

## üîê –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –û–ø–∏—Å–∞–Ω–∏–µ | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é |
|------------|----------|--------------|
| `PORT` | –ü–æ—Ä—Ç —Å–µ—Ä–≤–µ—Ä–∞ | `8000` |
| `TELEGRAM_BOT_TOKEN` | –¢–æ–∫–µ–Ω –±–æ—Ç–∞ –æ—Ç @BotFather | ‚Äî |
| `ADMIN_TELEGRAM_ID` | Telegram ID –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ | ‚Äî |
| `TEST_DB_PATH` | –ü—É—Ç—å –∫ SQLite –ë–î | `/tmp/events.db` |
| `DATABASE_URL` | PostgreSQL connection string | ‚Äî |
| `POLYMARKET_SYNC_INTERVAL` | –ò–Ω—Ç–µ—Ä–≤–∞–ª —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ (—Å–µ–∫) | `7200` |
| `CRYPTOBOT_API_TOKEN` | –¢–æ–∫–µ–Ω CryptoBot | ‚Äî |
| `SECRET_KEY` | –°–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á –¥–ª—è —Å–µ—Å—Å–∏–π | ‚Äî |

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ `.env.example` –≤ `.env` –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è.

---

## üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è |
|-----------|------------|
| **Backend** | Python 3.12, FastAPI 0.104, SQLAlchemy 2.0, Pydantic 2.5 |
| **Frontend** | Vanilla JavaScript, CSS3, Telegram WebApp SDK, Chart.js |
| **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö** | SQLite (dev/serverless), PostgreSQL (production) |
| **–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è** | Docker (multi-stage build –Ω–∞ Alpine) |
| **–í–Ω–µ—à–Ω–∏–µ API** | Polymarket Gamma API, Binance WebSocket API |
| **–ü–ª–∞—Ç–µ–∂–∏** | CryptoBot API |
| **–¢–µ—Å—Ç—ã** | pytest, pytest-cov, pytest-asyncio |

---

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License ‚Äî —Å–º. —Ñ–∞–π–ª [LICENSE](./LICENSE)

---

## ü§ù –ü–æ–¥–¥–µ—Ä–∂–∫–∞

- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –¥–µ–ø–ª–æ—é: [DEPLOY_ZEABUR.md](./DEPLOY_ZEABUR.md)
- API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: `/docs` (Swagger UI) –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞
- Telegram Bot: [@yourbot](https://t.me/yourbot)

---

## üîó Blockchain Integration

### –ö–æ–Ω—Ç—Ä–∞–∫—Ç—ã Polymarket –Ω–∞ Polygon (Chain ID: 137)

| –ö–æ–Ω—Ç—Ä–∞–∫—Ç | –ê–¥—Ä–µ—Å | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|----------|-------|------------|
| **USDC_E** | `0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174` | USD Coin (Bridged) ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–π —Å—Ç–µ–π–±–ª–∫–æ–∏–Ω –¥–ª—è —Ä–∞—Å—á—ë—Ç–æ–≤ |
| **CTF** | `0x4D97DCd97eC945f40cF65F87097ACe5EA0476045` | Conditional Tokens Framework ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ —Ä—ã–Ω–∫–æ–≤ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π |
| **CTF_EXCHANGE** | `0x4bFb41d5B3570DeFd03C39a9A4D8dE6Bd8B8982E` | DEX –¥–ª—è —Ç–æ—Ä–≥–æ–≤–ª–∏ –∞–∫—Ü–∏—è–º–∏ –∏—Å—Ö–æ–¥–æ–≤ (AMM) |
| **NEG_RISK_CTF_EXCHANGE** | `0xC5d563A36AE78145C45a50134d48A1215220f80a` | –ë–∏—Ä–∂–∞ –¥–ª—è —Ä—ã–Ω–∫–æ–≤ —Å –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã–º —Ä–∏—Å–∫–æ–º |

**–°—Ç–∞—Ç—É—Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏**: üü° **Prepared for Integration** (MVP –≥–æ—Ç–æ–≤, Web3 —Ñ—É–Ω–∫—Ü–∏–∏ –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ)

### –§–∞–π–ª—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

- **Backend**: [`api/config/polymarket_contracts.py`](./api/config/polymarket_contracts.py)
- **Frontend**: [`frontend/web3Config.ts`](./frontend/web3Config.ts)
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: [`WEB3_INTEGRATION.md`](./WEB3_INTEGRATION.md)

### –¢–µ–∫—É—â–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (Web2)

```
Frontend (Telegram) ‚Üí FastAPI Backend ‚Üí PostgreSQL + Polymarket API
```

### –¶–µ–ª–µ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (Web2 + Web3)

```
Frontend (Telegram + MetaMask) ‚Üí FastAPI Backend ‚Üí PostgreSQL + Polygon Blockchain
                                                      (USDC, CTF, CTF_EXCHANGE)
```

–ü–æ–¥—Ä–æ–±–Ω–µ–µ —Å–º. –≤ [`POLYMARKET_COMPATIBILITY.md`](./POLYMARKET_COMPATIBILITY.md)

---

## üó∫ Web3 Roadmap

| –≠—Ç–∞–ø | –ù–∞–∑–≤–∞–Ω–∏–µ | –°—Ç–∞—Ç—É—Å | –í—Ä–µ–º—è | –°—Ç–æ–∏–º–æ—Å—Ç—å |
|------|----------|--------|-------|-----------|
| **–≠—Ç–∞–ø 1** | –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ | ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ | 1 –¥–µ–Ω—å | $0 |
| **–≠—Ç–∞–ø 2** | –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫–æ—à–µ–ª—å–∫–∞ | üîµ Planned | 2-3 –¥–Ω—è | $50-100 |
| **–≠—Ç–∞–ø 3** | –ß—Ç–µ–Ω–∏–µ –∏–∑ –±–ª–æ–∫—á–µ–π–Ω–∞ | üîµ Planned | 3-4 –¥–Ω—è | $0-20 |
| **–≠—Ç–∞–ø 4** | –ó–∞–ø–∏—Å—å –≤ –±–ª–æ–∫—á–µ–π–Ω | üîµ Planned | 5-7 –¥–Ω–µ–π | $100-200 |
| **–≠—Ç–∞–ø 5** | Production –¥–µ–ø–ª–æ–π | üîµ Planned | 3-5 –¥–Ω–µ–π | $0-5000 |

**–ò—Ç–æ–≥–æ**: 14-20 –¥–Ω–µ–π, $150-5320 (–±–µ–∑ —É—á—ë—Ç–∞ –∞—É–¥–∏—Ç–∞ —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤)

### –î–µ—Ç–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–°–º. [`WEB3_INTEGRATION.md`](./WEB3_INTEGRATION.md) —Å:
- –û–ø–∏—Å–∞–Ω–∏–µ–º –∫–∞–∂–¥–æ–≥–æ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞
- –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
- –°—Ä–∞–≤–Ω–µ–Ω–∏–µ–º Web2 vs Web3 –º–æ–¥–µ–ª–∏
- –û—Ü–µ–Ω–∫–æ–π —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –∏ –≤—Ä–µ–º–µ–Ω–∏

---

## üìä –°—Ç–∞—Ç—É—Å –ø—Ä–æ–µ–∫—Ç–∞

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –°—Ç–∞—Ç—É—Å | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----------|--------|----------|
| **Frontend (Telegram WebApp)** | ‚úÖ MVP Ready | –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–µ–Ω |
| **Backend (FastAPI)** | ‚úÖ MVP Ready | –í—Å–µ endpoints —Ä–∞–±–æ—Ç–∞—é—Ç |
| **Betting Engine** | ‚úÖ MVP Ready | Long/Short, Up/Down, Event bets |
| **Polymarket Integration** | ‚úÖ MVP Ready | –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å–æ–±—ã—Ç–∏–π + probabilities |
| **Binance Charts** | ‚úÖ MVP Ready | Real-time –≥—Ä–∞—Ñ–∏–∫–∏ –¥–ª—è crypto |
| **Web3 Integration** | üü° Prepared | –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ –∑–∞–≥–ª—É—à–∫–∏ –≥–æ—Ç–æ–≤—ã |
| **On-chain Settlement** | üîµ Future | –¢—Ä–µ–±—É–µ—Ç—Å—è –¥–æ—Ä–∞–±–æ—Ç–∫–∞ |

**–û–±—â–∏–π —Å—Ç–∞—Ç—É—Å**: üü¢ **MVP Ready, Web3 Prepared**

---

## üìù Changelog

### v1.0.0 (–§–µ–≤—Ä–∞–ª—å 2026)
- ‚úÖ –ü–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è Betting Engine
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Polymarket API
- ‚úÖ Binance WebSocket –¥–ª—è —Ä–µ–∞–ª—å–Ω—ã—Ö —Ü–µ–Ω
- ‚úÖ Telegram WebApp –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- ‚úÖ –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
- ‚úÖ –¢–µ—Å—Ç—ã (90%+ –ø–æ–∫—Ä—ã—Ç–∏–µ)
- ‚úÖ Web3 –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (Prepared for Integration)
- ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Web3 –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

### v0.9.0 (–Ø–Ω–≤–∞—Ä—å 2026)
- ‚úÖ Polymarket —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å–æ–±—ã—Ç–∏–π
- ‚úÖ –ì—Ä–∞—Ñ–∏–∫–∏ –¥–ª—è crypto —Å–æ–±—ã—Ç–∏–π
- ‚úÖ –ö–æ—à–µ–ª—ë–∫ —á–µ—Ä–µ–∑ CryptoBot

### v0.8.0 (–î–µ–∫–∞–±—Ä—å 2025)
- ‚úÖ Betting Engine (Long/Short –ø–æ–∑–∏—Ü–∏–∏)
- ‚úÖ Telegram WebApp –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- ‚úÖ –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å

---

## üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã

- **GitHub**: https://github.com/yourusername/eventpredict
- **Telegram**: @yourbot
- **Polymarket**: https://polymarket.com/
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Polymarket**: https://docs.polymarket.com/
